{"version":3,"sources":["components/Login.js","hooks/useLocalStorage.js","contexts/ContactsProvider.js","contexts/SocketProvider.js","contexts/ConversationsProvider.js","components/Conversations.js","components/Contacts.js","components/NewContactModal.js","components/NewConversationModal.js","components/Sidebar.js","components/OpenConversation.js","components/Dashboard.js","components/App.js","index.js"],"names":["Login","onIdSubmit","idRef","useRef","Container","className","style","height","Form","onSubmit","e","preventDefault","current","value","Group","Label","Control","type","ref","required","Button","onClick","uuidV4","variant","useLocalStorage","key","initialValue","prefixedKey","useState","jsonValue","localStorage","getItem","JSON","parse","setValue","useEffect","setItem","stringify","ContactsContext","React","createContext","useContacts","useContext","ContactsProvider","children","contacts","setContacts","Provider","createContact","id","name","prevContacts","SocketContext","SocketProvider","socket","setSocket","newSocket","io","query","close","ConversationsContext","useConversations","ConversationsProvider","conversations","setConversations","selectedConversationIndex","setSelectedConversationIndex","addMessageToConversation","useCallback","recipients","text","sender","prevConversations","madeChange","newMessage","newConversations","map","conversation","a","b","length","sort","every","element","index","messages","on","off","formattedConversations","recipient","contact","find","message","fromMe","senderName","selected","selectedConversation","sendMessage","emit","selectConversationIndex","createConversation","Conversations","ListGroup","Item","action","active","r","join","Contacts","NewContactModal","closeModal","nameRef","Modal","Header","closeButton","Body","NewConversationModal","selectedContactIds","setSelectedContactIds","controlId","Check","includes","label","onChange","contactId","prevSelectedContactIds","filter","prevId","Sidebar","activeKey","setActiveKey","modalOpen","setModalOpen","conversationsOpen","width","Tab","onSelect","Nav","Link","eventKey","Content","Pane","show","onHide","OpenConversation","setText","setRef","node","scrollIntoView","smooth","lastMessage","InputGroup","as","target","resize","Append","Dashboard","App","setId","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c0bba669.chunk.js","sourcesContent":["import React, { useRef } from 'react'\r\nimport { Container, Form, Button } from 'react-bootstrap'\r\nimport { v4 as uuidV4 } from 'uuid'\r\n\r\nexport default function Login({ onIdSubmit }) {\r\n  const idRef = useRef()\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault()\r\n\r\n    onIdSubmit(idRef.current.value)\r\n  }\r\n\r\n  function createNewId() {\r\n    onIdSubmit(uuidV4())\r\n  }\r\n\r\n  return (\r\n    <Container className=\"align-items-center d-flex\" style={{ height: '100vh' }}>\r\n      <Form onSubmit={handleSubmit} className=\"w-100\">\r\n        <Form.Group>\r\n          <Form.Label>Enter Your Id</Form.Label>\r\n          <Form.Control type=\"text\" ref={idRef} required />\r\n        </Form.Group>   \r\n        <Button type=\"submit\" className=\"mr-2\">Login</Button>\r\n        <Button onClick={createNewId} variant=\"secondary\">Create A New Id</Button>\r\n      </Form>\r\n    </Container>\r\n  )\r\n}\r\n","import { useEffect, useState } from 'react'\r\n\r\nconst PREFIX = 'whatsapp-clone-'\r\n\r\nexport default function useLocalStorage(key, initialValue) {\r\n  const prefixedKey = PREFIX + key\r\n  const [value, setValue] = useState(() => {\r\n    const jsonValue = localStorage.getItem(prefixedKey)\r\n    if (jsonValue != null) return JSON.parse(jsonValue)\r\n    if (typeof initialValue === 'function') {\r\n      return initialValue()\r\n    } else {\r\n      return initialValue\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(prefixedKey, JSON.stringify(value))\r\n  }, [prefixedKey, value])\r\n\r\n  return [value, setValue]\r\n}\r\n","import React, { useContext } from 'react'\r\nimport useLocalStorage from '../hooks/useLocalStorage';\r\n\r\nconst ContactsContext = React.createContext()\r\n\r\nexport function useContacts() {\r\n  return useContext(ContactsContext)\r\n}\r\n\r\nexport function ContactsProvider({ children }) {\r\n  const [contacts, setContacts] = useLocalStorage('contacts', [])\r\n\r\n  function createContact(id, name) {\r\n    setContacts(prevContacts => {\r\n      return [...prevContacts, { id, name }]\r\n    })\r\n  }\r\n\r\n  return (\r\n    <ContactsContext.Provider value={{ contacts, createContact }}>\r\n      {children}\r\n    </ContactsContext.Provider>\r\n  )\r\n}\r\n","import React, { useContext, useEffect, useState } from 'react'\r\nimport io from 'socket.io-client'\r\n\r\nconst SocketContext = React.createContext()\r\n\r\nexport function useSocket() {\r\n  return useContext(SocketContext)\r\n}\r\n\r\nexport function SocketProvider({ id, children }) {\r\n  const [socket, setSocket] = useState()\r\n\r\n  useEffect(() => {\r\n    const newSocket = io(\r\n      'http://localhost:5000',\r\n      { query: { id } }\r\n    )\r\n    setSocket(newSocket)\r\n\r\n    return () => newSocket.close()\r\n  }, [id])\r\n\r\n  return (\r\n    <SocketContext.Provider value={socket}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  )\r\n}\r\n","import React, { useContext, useState, useEffect, useCallback } from 'react'\r\nimport useLocalStorage from '../hooks/useLocalStorage';\r\nimport { useContacts } from './ContactsProvider';\r\nimport { useSocket } from './SocketProvider';\r\n\r\nconst ConversationsContext = React.createContext()\r\n\r\nexport function useConversations() {\r\n  return useContext(ConversationsContext)\r\n}\r\n\r\nexport function ConversationsProvider({ id, children }) {\r\n  const [conversations, setConversations] = useLocalStorage('conversations', [])\r\n  const [selectedConversationIndex, setSelectedConversationIndex] = useState(0)\r\n  const { contacts } = useContacts()\r\n  const socket = useSocket()\r\n\r\n  function createConversation(recipients) {\r\n    setConversations(prevConversations => {\r\n      return [...prevConversations, { recipients, messages: [] }]\r\n    })\r\n  }\r\n\r\n  const addMessageToConversation = useCallback(({ recipients, text, sender }) => {\r\n    setConversations(prevConversations => {\r\n      let madeChange = false\r\n      const newMessage = { sender, text }\r\n      const newConversations = prevConversations.map(conversation => {\r\n        if (arrayEquality(conversation.recipients, recipients)) {\r\n          madeChange = true\r\n          return {\r\n            ...conversation,\r\n            messages: [...conversation.messages, newMessage]\r\n          }\r\n        }\r\n\r\n        return conversation\r\n      })\r\n\r\n      if (madeChange) {\r\n        return newConversations\r\n      } else {\r\n        return [\r\n          ...prevConversations,\r\n          { recipients, messages: [newMessage] }\r\n        ]\r\n      }\r\n    })\r\n  }, [setConversations])\r\n\r\n  useEffect(() => {\r\n    if (socket == null) return\r\n\r\n    socket.on('receive-message', addMessageToConversation)\r\n\r\n    return () => socket.off('receive-message')\r\n  }, [socket, addMessageToConversation])\r\n\r\n  function sendMessage(recipients, text) {\r\n    socket.emit('send-message', { recipients, text })\r\n\r\n    addMessageToConversation({ recipients, text, sender: id })\r\n  }\r\n\r\n  const formattedConversations = conversations.map((conversation, index) => {\r\n    const recipients = conversation.recipients.map(recipient => {\r\n      const contact = contacts.find(contact => {\r\n        return contact.id === recipient\r\n      })\r\n      const name = (contact && contact.name) || recipient\r\n      return { id: recipient, name }\r\n    })\r\n\r\n    const messages = conversation.messages.map(message => {\r\n      const contact = contacts.find(contact => {\r\n        return contact.id === message.sender\r\n      })\r\n      const name = (contact && contact.name) || message.sender\r\n      const fromMe = id === message.sender\r\n      return { ...message, senderName: name, fromMe }\r\n    })\r\n    \r\n    const selected = index === selectedConversationIndex\r\n    return { ...conversation, messages, recipients, selected }\r\n  })\r\n\r\n  const value = {\r\n    conversations: formattedConversations,\r\n    selectedConversation: formattedConversations[selectedConversationIndex],\r\n    sendMessage,\r\n    selectConversationIndex: setSelectedConversationIndex,\r\n    createConversation\r\n  }\r\n\r\n  return (\r\n    <ConversationsContext.Provider value={value}>\r\n      {children}\r\n    </ConversationsContext.Provider>\r\n  )\r\n}\r\n\r\nfunction arrayEquality(a, b) {\r\n  if (a.length !== b.length) return false\r\n\r\n  a.sort()\r\n  b.sort()\r\n\r\n  return a.every((element, index) => {\r\n    return element === b[index]\r\n  })\r\n}","import React from 'react'\r\nimport { ListGroup } from 'react-bootstrap'\r\nimport { useConversations } from '../contexts/ConversationsProvider';\r\n\r\nexport default function Conversations() {\r\n  const { conversations, selectConversationIndex } = useConversations()\r\n\r\n  return (\r\n    <ListGroup variant=\"flush\">\r\n      {conversations.map((conversation, index) => (\r\n        <ListGroup.Item\r\n          key={index}\r\n          action\r\n          onClick={() => selectConversationIndex(index)}\r\n          active={conversation.selected}\r\n        >\r\n          {conversation.recipients.map(r => r.name).join(', ')}\r\n        </ListGroup.Item>\r\n      ))}\r\n    </ListGroup>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { ListGroup } from 'react-bootstrap'\r\nimport { useContacts } from '../contexts/ContactsProvider';\r\n\r\nexport default function Contacts() {\r\n  const { contacts } = useContacts()\r\n\r\n  return (\r\n    <ListGroup variant=\"flush\">\r\n      {contacts.map(contact => (\r\n        <ListGroup.Item key={contact.id}>\r\n          {contact.name}\r\n        </ListGroup.Item>\r\n      ))}\r\n    </ListGroup>\r\n  )\r\n}\r\n","import React, { useRef } from 'react'\r\nimport { Modal, Form, Button } from 'react-bootstrap'\r\nimport { useContacts } from '../contexts/ContactsProvider'\r\n\r\nexport default function NewContactModal({ closeModal }) {\r\n  const idRef = useRef()\r\n  const nameRef = useRef()\r\n  const { createContact } = useContacts()\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault()\r\n\r\n    createContact(idRef.current.value, nameRef.current.value)\r\n    closeModal()\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Modal.Header closeButton>Create Contact</Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit}>\r\n          <Form.Group>\r\n            <Form.Label>Id</Form.Label>\r\n            <Form.Control type=\"text\" ref={idRef} required />\r\n          </Form.Group>\r\n          <Form.Group>\r\n            <Form.Label>Name</Form.Label>\r\n            <Form.Control type=\"text\" ref={nameRef} required />\r\n          </Form.Group>\r\n          <Button type=\"submit\">Create</Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Modal, Form, Button } from 'react-bootstrap'\r\nimport { useContacts } from '../contexts/ContactsProvider'\r\nimport { useConversations } from '../contexts/ConversationsProvider'\r\n\r\nexport default function NewConversationModal({ closeModal }) {\r\n  const [selectedContactIds, setSelectedContactIds] = useState([])\r\n  const { contacts } = useContacts()\r\n  const { createConversation } = useConversations()\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault()\r\n\r\n    createConversation(selectedContactIds)\r\n    closeModal()\r\n  }\r\n\r\n  function handleCheckboxChange(contactId) {\r\n    setSelectedContactIds(prevSelectedContactIds => {\r\n      if (prevSelectedContactIds.includes(contactId)) {\r\n        return prevSelectedContactIds.filter(prevId => {\r\n          return contactId !== prevId\r\n        })\r\n      } else {\r\n        return [...prevSelectedContactIds, contactId]\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Modal.Header closeButton>Create Conversation</Modal.Header>\r\n      <Modal.Body>\r\n        <Form onSubmit={handleSubmit}>\r\n          {contacts.map(contact => (\r\n            <Form.Group controlId={contact.id} key={contact.id}>\r\n              <Form.Check\r\n                type=\"checkbox\"\r\n                value={selectedContactIds.includes(contact.id)}\r\n                label={contact.name}\r\n                onChange={() => handleCheckboxChange(contact.id)}\r\n              />\r\n            </Form.Group>\r\n          ))}\r\n          <Button type=\"submit\">Create</Button>\r\n        </Form>\r\n      </Modal.Body>\r\n    </>\r\n  )\r\n}\r\n","import React, { useState } from 'react'\r\nimport { Tab, Nav, Button, Modal } from 'react-bootstrap'\r\nimport Conversations from './Conversations'\r\nimport Contacts from './Contacts'\r\nimport NewContactModal from './NewContactModal'\r\nimport NewConversationModal from './NewConversationModal'\r\n\r\nconst CONVERSATIONS_KEY = 'conversations'\r\nconst CONTACTS_KEY = 'contacts'\r\n\r\nexport default function Sidebar({ id }) {\r\n  const [activeKey, setActiveKey] = useState(CONVERSATIONS_KEY)\r\n  const [modalOpen, setModalOpen] = useState(false)\r\n  const conversationsOpen = activeKey === CONVERSATIONS_KEY\r\n  \r\n  function closeModal() {\r\n    setModalOpen(false)\r\n  }\r\n\r\n  return (\r\n    <div style={{ width: '250px' }} className=\"d-flex flex-column\">\r\n      <Tab.Container activeKey={activeKey} onSelect={setActiveKey}>\r\n        <Nav variant=\"tabs\" className=\"justify-content-center\">\r\n          <Nav.Item>\r\n            <Nav.Link eventKey={CONVERSATIONS_KEY}>Conversations</Nav.Link>\r\n          </Nav.Item>\r\n          <Nav.Item>\r\n            <Nav.Link eventKey={CONTACTS_KEY}>Contacts</Nav.Link>\r\n          </Nav.Item>\r\n        </Nav>\r\n        <Tab.Content className=\"border-right overflow-auto flex-grow-1\">\r\n          <Tab.Pane eventKey={CONVERSATIONS_KEY}>\r\n            <Conversations />\r\n          </Tab.Pane>\r\n          <Tab.Pane eventKey={CONTACTS_KEY}>\r\n            <Contacts />\r\n          </Tab.Pane>\r\n        </Tab.Content>\r\n        <div className=\"p-2 border-top border-right small\">\r\n          Your Id: <span className=\"text-muted\">{id}</span>\r\n        </div>\r\n        <Button onClick={() => setModalOpen(true)} className=\"rounded-0\">\r\n          New {conversationsOpen ? 'Conversation' : 'Contact'}\r\n        </Button>\r\n      </Tab.Container>\r\n\r\n      <Modal show={modalOpen} onHide={closeModal}>\r\n        {conversationsOpen ?\r\n          <NewConversationModal closeModal={closeModal} /> :\r\n          <NewContactModal closeModal={closeModal} />\r\n        }\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState, useCallback } from 'react'\r\nimport { Form, InputGroup, Button } from 'react-bootstrap'\r\nimport { useConversations } from '../contexts/ConversationsProvider';\r\n\r\nexport default function OpenConversation() {\r\n  const [text, setText] = useState('')\r\n  const setRef = useCallback(node => {\r\n    if (node) {\r\n      node.scrollIntoView({ smooth: true })\r\n    }\r\n  }, [])\r\n  const { sendMessage, selectedConversation } = useConversations()\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault()\r\n\r\n    sendMessage(\r\n      selectedConversation.recipients.map(r => r.id),\r\n      text\r\n    )\r\n    setText('')\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex flex-column flex-grow-1\">\r\n      <div className=\"flex-grow-1 overflow-auto\">\r\n        <div className=\"d-flex flex-column align-items-start justify-content-end px-3\">\r\n          {selectedConversation.messages.map((message, index) => {\r\n            const lastMessage = selectedConversation.messages.length - 1 === index\r\n            return (\r\n              <div\r\n                ref={lastMessage ? setRef : null}\r\n                key={index}\r\n                className={`my-1 d-flex flex-column ${message.fromMe ? 'align-self-end align-items-end' : 'align-items-start'}`}\r\n              >\r\n                <div\r\n                  className={`rounded px-2 py-1 ${message.fromMe ? 'bg-primary text-white' : 'border'}`}>\r\n                  {message.text}\r\n                </div>\r\n                <div className={`text-muted small ${message.fromMe ? 'text-right' : ''}`}>\r\n                  {message.fromMe ? 'You' : message.senderName}\r\n                </div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n      <Form onSubmit={handleSubmit}>\r\n        <Form.Group className=\"m-2\">\r\n          <InputGroup>\r\n            <Form.Control\r\n              as=\"textarea\"\r\n              required\r\n              value={text}\r\n              onChange={e => setText(e.target.value)}\r\n              style={{ height: '75px', resize: 'none' }}\r\n            />\r\n            <InputGroup.Append>\r\n              <Button type=\"submit\">Send</Button>\r\n            </InputGroup.Append>\r\n          </InputGroup>\r\n        </Form.Group>\r\n      </Form>\r\n    </div>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Sidebar from './Sidebar';\r\nimport OpenConversation from './OpenConversation';\r\nimport { useConversations } from '../contexts/ConversationsProvider';\r\n\r\nexport default function Dashboard({ id }) {\r\n  const { selectedConversation } = useConversations()\r\n\r\n  return (\r\n    <div className=\"d-flex\" style={{ height: '100vh' }}>\r\n      <Sidebar id={id} />\r\n      {selectedConversation && <OpenConversation />}\r\n    </div>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Login from './Login'\r\nimport useLocalStorage from '../hooks/useLocalStorage';\r\nimport Dashboard from './Dashboard'\r\nimport { ContactsProvider } from '../contexts/ContactsProvider'\r\nimport { ConversationsProvider } from '../contexts/ConversationsProvider';\r\nimport { SocketProvider } from '../contexts/SocketProvider';\r\n\r\nfunction App() {\r\n  const [id, setId] = useLocalStorage('id')\r\n\r\n  const dashboard = (\r\n    <SocketProvider id={id}>\r\n      <ContactsProvider>\r\n        <ConversationsProvider id={id}>\r\n          <Dashboard id={id} />\r\n        </ConversationsProvider>\r\n      </ContactsProvider>\r\n    </SocketProvider>\r\n  )\r\n\r\n  return (\r\n    id ? dashboard : <Login onIdSubmit={setId} />\r\n  )\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./components/App\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}